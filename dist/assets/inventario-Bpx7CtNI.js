import{c as m,r as a,j as e,G as N,A as V,e as oe,a as S,X as K,M as ce,U as de,d as xe,b as he,C as F,g as me,R as ue}from"./index-BK5FbDdt.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=m("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=m("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=m("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=m("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=m("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=m("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=m("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=m("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=m("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=m("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=m("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=m("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=m("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=m("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),I="",k={login:`${I}/api/inventory/login`,logout:`${I}/api/inventory/logout`,verify:`${I}/api/inventory/verify`,changePassword:`${I}/api/inventory/change-password`,items:`${I}/api/inventory/items`,stats:`${I}/api/inventory/stats`,itemById:t=>`${I}/api/inventory/items/${t}`},we=({onLoginSuccess:t})=>{const[h,c]=a.useState(""),[n,b]=a.useState(""),[r,l]=a.useState(""),[x,f]=a.useState(!1),p=async d=>{d.preventDefault(),l(""),f(!0);try{const o=await fetch(k.login,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:h,password:n})}),C=await o.json();o.ok&&C.success?t(C.user,C.requiere_cambio_password||!1):l(C.error||"Error al iniciar sesión")}catch(o){console.error("Error de conexión:",o),l("Error de conexión con el servidor. Asegúrate de que el servidor esté ejecutándose.")}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"})]}),e.jsx(N,{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-blue-500/20 to-purple-500/20 border-2 border-white/30 rounded-full flex items-center justify-center backdrop-blur-sm shadow-lg mb-4",children:e.jsx(T,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Sistema de Inventario"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Málaga Space Team"})]}),r&&e.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg flex items-start space-x-3",children:[e.jsx(V,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-red-200 text-sm",children:r})]}),e.jsxs("form",{onSubmit:p,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-white/90 text-sm font-medium mb-2",children:"Usuario"}),e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/40"}),e.jsx("input",{id:"username",type:"text",value:h,onChange:d=>c(d.target.value),className:"w-full pl-11 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50 focus:border-transparent transition-all",placeholder:"Ingresa tu usuario",required:!0,disabled:x})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-white/90 text-sm font-medium mb-2",children:"Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/40"}),e.jsx("input",{id:"password",type:"password",value:n,onChange:d=>b(d.target.value),className:"w-full pl-11 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50 focus:border-transparent transition-all",placeholder:"Ingresa tu contraseña",required:!0,disabled:x})]})]}),e.jsx(S,{type:"submit",variant:"primary",size:"lg",className:"w-full",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-5 h-5 mr-2 animate-spin"}),"Iniciando sesión..."]}):"Iniciar Sesión"})]})]})})]})},ye=({item:t,onSave:h,onClose:c})=>{const[n,b]=a.useState({nombre:"",numero_serie:"",descripcion:"",categoria:"",ubicacion:"",responsable:"",cantidad:1,estado:"Disponible",notas:""});a.useEffect(()=>{t&&b({nombre:t.nombre||"",numero_serie:t.numero_serie||"",descripcion:t.descripcion||"",categoria:t.categoria||"",ubicacion:t.ubicacion||"",responsable:t.responsable||"",cantidad:t.cantidad||1,estado:t.estado||"Disponible",notas:t.notas||""})},[t]);const r=x=>{x.preventDefault(),h(n)},l=x=>{const{name:f,value:p}=x.target;b(d=>({...d,[f]:p}))};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsx(N,{className:"w-full max-w-2xl max-h-[90vh] overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 border border-blue-500/30 rounded-lg flex items-center justify-center",children:e.jsx(A,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t?"Editar Item":"Nuevo Item"}),e.jsx("p",{className:"text-white/60 text-sm",children:t?"Modifica la información del item":"Añade un nuevo item al inventario"})]})]}),e.jsx("button",{onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:e.jsx(K,{className:"w-5 h-5 text-white/90"})})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4 max-h-[calc(90vh-200px)] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white/90 text-sm font-medium mb-2",children:["Nombre ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"nombre",value:n.nombre,onChange:l,required:!0,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50",placeholder:"Ej: Arduino Uno"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Número de Serie"}),e.jsx("input",{type:"text",name:"numero_serie",value:n.numero_serie,onChange:l,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50",placeholder:"Ej: SN12345678"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Descripción"}),e.jsx("textarea",{name:"descripcion",value:n.descripcion,onChange:l,rows:2,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50 resize-none",placeholder:"Breve descripción del item..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Categoría"}),e.jsx("input",{type:"text",name:"categoria",value:n.categoria,onChange:l,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50",placeholder:"Ej: Electrónica",list:"categorias"}),e.jsxs("datalist",{id:"categorias",children:[e.jsx("option",{value:"Electrónica"}),e.jsx("option",{value:"Mecánica"}),e.jsx("option",{value:"Software"}),e.jsx("option",{value:"Herramientas"}),e.jsx("option",{value:"Materiales"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Estado"}),e.jsxs("select",{name:"estado",value:n.estado,onChange:l,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-400/50",children:[e.jsx("option",{value:"Disponible",children:"Disponible"}),e.jsx("option",{value:"En uso",children:"En uso"}),e.jsx("option",{value:"Mantenimiento",children:"Mantenimiento"}),e.jsx("option",{value:"Dañado",children:"Dañado"}),e.jsx("option",{value:"Prestado",children:"Prestado"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Ubicación"}),e.jsx("input",{type:"text",name:"ubicacion",value:n.ubicacion,onChange:l,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50",placeholder:"Ej: Lab A, Estante 3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Responsable"}),e.jsx("input",{type:"text",name:"responsable",value:n.responsable,onChange:l,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50",placeholder:"Nombre de la persona"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Cantidad"}),e.jsx("input",{type:"number",name:"cantidad",value:n.cantidad,onChange:l,min:"1",className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/90 text-sm font-medium mb-2",children:"Notas"}),e.jsx("textarea",{name:"notas",value:n.notas,onChange:l,rows:3,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50 resize-none",placeholder:"Información adicional..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-white/10",children:[e.jsx(S,{type:"button",variant:"secondary",size:"md",onClick:c,children:"Cancelar"}),e.jsxs(S,{type:"submit",variant:"primary",size:"md",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),t?"Guardar Cambios":"Crear Item"]})]})]})]})})})},ve=({itemName:t,onConfirm:h,onClose:c})=>e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsx(N,{className:"w-full max-w-md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/20 border border-red-500/30 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(be,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Esta acción no se puede deshacer"})]})]}),e.jsx("button",{onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:e.jsx(K,{className:"w-5 h-5 text-white/90"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[e.jsx("p",{className:"text-white/90 mb-2",children:"¿Estás seguro de que deseas eliminar el siguiente item?"}),e.jsxs("p",{className:"text-white font-semibold text-lg",children:['"',t,'"']})]}),e.jsx("p",{className:"text-white/70 text-sm mt-4",children:"El item será eliminado permanentemente del inventario. Esta acción solo está disponible para administradores."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{variant:"secondary",size:"md",onClick:c,children:"Cancelar"}),e.jsxs("button",{onClick:h,className:"px-6 py-2 bg-red-500/80 hover:bg-red-500 text-white font-semibold rounded-lg transition-all flex items-center space-x-2 border border-red-400/30",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Eliminar"})]})]})]})})}),Ne=({user:t,onLogout:h})=>{const[c,n]=a.useState([]),[b,r]=a.useState([]),[l,x]=a.useState(""),[f,p]=a.useState(!0),[d,o]=a.useState(!1),[C,E]=a.useState(!1),[j,P]=a.useState(null),[g,L]=a.useState(null),[w,D]=a.useState(""),[y,u]=a.useState(""),M=async()=>{p(!0);try{const i=await(await fetch(k.items,{credentials:"include"})).json();i.success&&(n(i.items),r(i.items))}catch(s){console.error("Error al cargar items:",s)}finally{p(!1)}},v=async()=>{try{const i=await(await fetch(k.stats,{credentials:"include"})).json();i.success&&L(i.stats)}catch(s){console.error("Error al cargar estadísticas:",s)}};a.useEffect(()=>{M(),v()},[]),a.useEffect(()=>{let s=c;if(l){const i=l.toLowerCase();s=s.filter(z=>{var O,B,G,Z;return z.nombre.toLowerCase().includes(i)||((O=z.numero_serie)==null?void 0:O.toLowerCase().includes(i))||((B=z.descripcion)==null?void 0:B.toLowerCase().includes(i))||((G=z.ubicacion)==null?void 0:G.toLowerCase().includes(i))||((Z=z.responsable)==null?void 0:Z.toLowerCase().includes(i))})}w&&(s=s.filter(i=>i.categoria===w)),y&&(s=s.filter(i=>i.estado===y)),r(s)},[l,c,w,y]);const _=async()=>{try{await fetch(k.logout,{method:"POST",credentials:"include"}),h()}catch(s){console.error("Error al cerrar sesión:",s)}},H=()=>{P(null),o(!0)},Y=s=>{P(s),o(!0)},ee=s=>{P(s),E(!0)},se=async s=>{try{const i=j?k.itemById(j.id):k.items;(await(await fetch(i,{method:j?"PUT":"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)})).json()).success&&(o(!1),M(),v())}catch(i){console.error("Error al guardar item:",i)}},te=async()=>{if(j)try{(await(await fetch(k.itemById(j.id),{method:"DELETE",credentials:"include"})).json()).success&&(E(!1),M(),v())}catch(s){console.error("Error al eliminar item:",s)}},ae=s=>{switch(s){case"Disponible":return e.jsx(F,{className:"w-4 h-4 text-green-400"});case"En uso":return e.jsx(he,{className:"w-4 h-4 text-blue-400"});case"Mantenimiento":return e.jsx(V,{className:"w-4 h-4 text-yellow-400"});case"Dañado":return e.jsx(xe,{className:"w-4 h-4 text-red-400"});default:return e.jsx(A,{className:"w-4 h-4 text-gray-400"})}},re=s=>{switch(s){case"admin":return"bg-purple-500/20 text-purple-300 border-purple-500/30";case"manager":return"bg-blue-500/20 text-blue-300 border-blue-500/30";case"viewer":return"bg-green-500/20 text-green-300 border-green-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}},q=t.rol==="manager"||t.rol==="admin",le=t.rol==="admin",ne=[...new Set(c.map(s=>s.categoria).filter(Boolean))],ie=[...new Set(c.map(s=>s.estado))];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4 md:p-8",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[e.jsx(N,{className:"mb-6",children:e.jsxs("div",{className:"p-6 flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Sistema de Inventario"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-white/70",children:["Bienvenido, ",e.jsx("span",{className:"font-semibold text-white",children:t.nombre_completo})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${re(t.rol)}`,children:t.rol.toUpperCase()})]})]}),e.jsxs(S,{variant:"secondary",size:"md",onClick:_,children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Cerrar Sesión"]})]})}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(N,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(A,{className:"w-8 h-8 text-blue-400"}),e.jsx(U,{className:"w-5 h-5 text-white/40"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:g.totalItems}),e.jsx("div",{className:"text-white/60 text-sm",children:"Total Items"})]})}),e.jsx(N,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ce,{className:"w-8 h-8 text-purple-400"}),e.jsx(U,{className:"w-5 h-5 text-white/40"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:g.byLocation.length}),e.jsx("div",{className:"text-white/60 text-sm",children:"Ubicaciones"})]})}),e.jsx(N,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(de,{className:"w-8 h-8 text-orange-400"}),e.jsx(U,{className:"w-5 h-5 text-white/40"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:g.byCategory.length}),e.jsx("div",{className:"text-white/60 text-sm",children:"Categorías"})]})})]}),e.jsx(N,{className:"mb-6",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(je,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/40"}),e.jsx("input",{type:"text",value:l,onChange:s=>x(s.target.value),placeholder:"Buscar por nombre, número de serie, ubicación, responsable...",className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-blue-400/50 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"flex gap-2",children:[q&&e.jsxs(S,{variant:"primary",size:"md",onClick:H,children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Nuevo Item"]}),e.jsx(S,{variant:"secondary",size:"md",onClick:M,children:e.jsx(X,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("select",{value:w,onChange:s=>D(s.target.value),className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/50",children:[e.jsx("option",{value:"",children:"Todas las categorías"}),ne.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:y,onChange:s=>u(s.target.value),className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/50",children:[e.jsx("option",{value:"",children:"Todos los estados"}),ie.map(s=>e.jsx("option",{value:s,children:s},s))]}),(w||y)&&e.jsx("button",{onClick:()=>{D(""),u("")},className:"px-4 py-2 text-white/70 hover:text-white text-sm transition-colors",children:"Limpiar filtros"})]})]})}),e.jsx(N,{children:e.jsx("div",{className:"overflow-x-auto",children:f?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(X,{className:"w-8 h-8 text-white/40 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Cargando inventario..."})]}):b.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(A,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),e.jsx("p",{className:"text-white/60 mb-2",children:l||w||y?"No se encontraron items con los filtros aplicados":"No hay items en el inventario"}),q&&!l&&!w&&!y&&e.jsxs(S,{variant:"primary",size:"sm",onClick:H,className:"mt-4",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Añadir Primer Item"]})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Nombre"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Nº Serie"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Categoría"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Ubicación"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Responsable"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Cantidad"}),e.jsx("th",{className:"text-left p-4 text-white/80 font-semibold text-sm",children:"Estado"}),e.jsx("th",{className:"text-right p-4 text-white/80 font-semibold text-sm",children:"Acciones"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:s.nombre}),s.descripcion&&e.jsx("div",{className:"text-xs text-white/60 mt-1",children:s.descripcion})]}),e.jsx("td",{className:"p-4 text-white/70 text-sm",children:s.numero_serie||"-"}),e.jsx("td",{className:"p-4",children:s.categoria&&e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 text-xs rounded-full",children:s.categoria})}),e.jsx("td",{className:"p-4 text-white/70 text-sm",children:s.ubicacion||"-"}),e.jsx("td",{className:"p-4 text-white/70 text-sm",children:s.responsable||"-"}),e.jsx("td",{className:"p-4 text-white/70 text-sm text-center",children:s.cantidad}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[ae(s.estado),e.jsx("span",{className:"text-white/70 text-sm",children:s.estado})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[q&&e.jsx("button",{onClick:()=>Y(s),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Editar",children:e.jsx(ge,{className:"w-4 h-4 text-blue-400"})}),le&&e.jsx("button",{onClick:()=>ee(s),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Eliminar",children:e.jsx(W,{className:"w-4 h-4 text-red-400"})})]})})]},s.id))})]})})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-white/40 text-sm",children:["Mostrando ",b.length," de ",c.length," items"]})})]}),d&&e.jsx(ye,{item:j,onSave:se,onClose:()=>o(!1)}),C&&j&&e.jsx(ve,{itemName:j.nombre,onConfirm:te,onClose:()=>E(!1)})]})},ke=({isFirstTime:t=!1,onSuccess:h,onCancel:c})=>{const[n,b]=a.useState(""),[r,l]=a.useState(""),[x,f]=a.useState(""),[p,d]=a.useState(!1),[o,C]=a.useState(!1),[E,j]=a.useState(!1),[P,g]=a.useState(""),[L,w]=a.useState(!1),D=u=>u.length<6?"La contraseña debe tener al menos 6 caracteres":u==="cambiarme123"?"No puedes usar la contraseña por defecto":null,y=async u=>{if(u.preventDefault(),g(""),!n||!r||!x){g("Todos los campos son obligatorios");return}const M=D(r);if(M){g(M);return}if(r!==x){g("Las contraseñas no coinciden");return}if(n===r){g("La nueva contraseña debe ser diferente a la actual");return}w(!0);try{const v=await fetch(k.changePassword,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({current_password:n,new_password:r})}),_=await v.json();if(!v.ok)throw new Error(_.error||"Error al cambiar la contraseña");h()}catch(v){g(v instanceof Error?v.message:"Error al cambiar la contraseña")}finally{w(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-8 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e.jsx(T,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"Cambiar Contraseña":"Actualizar Contraseña"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t?"Primera vez - Cambio obligatorio":"Configuración de seguridad"})]})]}),t&&e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Debes cambiar tu contraseña"}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:"Por seguridad, es obligatorio cambiar la contraseña temporal en el primer acceso."})]})]})}),P&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:P})}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contraseña Actual"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",value:n,onChange:u=>b(u.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-white pr-12",placeholder:"Tu contraseña actual",required:!0}),e.jsx("button",{type:"button",onClick:()=>d(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:p?e.jsx(R,{size:20}):e.jsx($,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nueva Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",value:r,onChange:u=>l(u.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-white pr-12",placeholder:"Mínimo 6 caracteres",required:!0}),e.jsx("button",{type:"button",onClick:()=>C(!o),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:o?e.jsx(R,{size:20}):e.jsx($,{size:20})})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:'Mínimo 6 caracteres, no uses "cambiarme123"'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmar Nueva Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:E?"text":"password",value:x,onChange:u=>f(u.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-white pr-12",placeholder:"Repite tu nueva contraseña",required:!0}),e.jsx("button",{type:"button",onClick:()=>j(!E),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:E?e.jsx(R,{size:20}):e.jsx($,{size:20})})]})]}),r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(F,{className:`w-4 h-4 ${r.length>=6?"text-green-500":"text-gray-400"}`}),e.jsx("span",{className:r.length>=6?"text-green-600 dark:text-green-400":"text-gray-500",children:"Al menos 6 caracteres"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(F,{className:`w-4 h-4 ${r!=="cambiarme123"?"text-green-500":"text-gray-400"}`}),e.jsx("span",{className:r!=="cambiarme123"?"text-green-600 dark:text-green-400":"text-gray-500",children:"No es la contraseña por defecto"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[!t&&c&&e.jsx("button",{type:"button",onClick:c,className:"flex-1 px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:L,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Actualizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{size:20}),"Cambiar Contraseña"]})})]})]})]})})},Ce=()=>{const[t,h]=a.useState(null),[c,n]=a.useState(!0),[b,r]=a.useState(!1);a.useEffect(()=>{l()},[]);const l=async()=>{try{const d=await fetch(k.verify,{credentials:"include"});if(d.ok){const o=await d.json();o.success&&o.user&&(h(o.user),o.user.requiere_cambio_password&&r(!0))}}catch(d){console.error("Error al verificar sesión:",d)}finally{n(!1)}},x=(d,o)=>{h(d),o&&r(!0)},f=()=>{r(!1),t&&h({...t,requiere_cambio_password:!1})},p=()=>{h(null),r(!1)};return c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"w-12 h-12 text-white/40 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Verificando sesión..."})]})}):e.jsx(e.Fragment,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{user:t,onLogout:p}),b&&e.jsx(ke,{isFirstTime:!0,onSuccess:f})]}):e.jsx(we,{onLoginSuccess:x})})};me.createRoot(document.getElementById("root")).render(e.jsx(ue.StrictMode,{children:e.jsx(Ce,{})}));
